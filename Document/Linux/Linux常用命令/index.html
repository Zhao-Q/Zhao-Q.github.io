<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux 常用命令</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link,[object Object]></link,[object Object]>
    <meta name="description" content="Development Notes">
    
    <link rel="preload" href="/assets/css/0.styles.926dad4f.css" as="style"><link rel="preload" href="/assets/js/app.77c060c5.js" as="script"><link rel="preload" href="/assets/js/2.dd98a60a.js" as="script"><link rel="preload" href="/assets/js/3.4b608a10.js" as="script"><link rel="prefetch" href="/assets/js/10.85d0207a.js"><link rel="prefetch" href="/assets/js/11.797ae897.js"><link rel="prefetch" href="/assets/js/12.d763f280.js"><link rel="prefetch" href="/assets/js/13.fea9c5ed.js"><link rel="prefetch" href="/assets/js/14.7220a1b8.js"><link rel="prefetch" href="/assets/js/15.82d28b4d.js"><link rel="prefetch" href="/assets/js/16.31282ee5.js"><link rel="prefetch" href="/assets/js/17.a6ab6c51.js"><link rel="prefetch" href="/assets/js/18.d429b125.js"><link rel="prefetch" href="/assets/js/19.2d1ea51c.js"><link rel="prefetch" href="/assets/js/20.eea320ad.js"><link rel="prefetch" href="/assets/js/21.2e1fccb4.js"><link rel="prefetch" href="/assets/js/22.645a5f5e.js"><link rel="prefetch" href="/assets/js/23.0ba0c9f7.js"><link rel="prefetch" href="/assets/js/24.b4c88f15.js"><link rel="prefetch" href="/assets/js/25.290d43ae.js"><link rel="prefetch" href="/assets/js/26.e07c5eb3.js"><link rel="prefetch" href="/assets/js/27.ee44bc93.js"><link rel="prefetch" href="/assets/js/28.ea2244d2.js"><link rel="prefetch" href="/assets/js/29.ec2f8f2a.js"><link rel="prefetch" href="/assets/js/30.414ce9ef.js"><link rel="prefetch" href="/assets/js/31.446f1dbd.js"><link rel="prefetch" href="/assets/js/32.56c95b80.js"><link rel="prefetch" href="/assets/js/33.4393c80b.js"><link rel="prefetch" href="/assets/js/34.fd0f68be.js"><link rel="prefetch" href="/assets/js/35.d1caeeaa.js"><link rel="prefetch" href="/assets/js/36.f38f978f.js"><link rel="prefetch" href="/assets/js/37.7cb673a4.js"><link rel="prefetch" href="/assets/js/38.f7323199.js"><link rel="prefetch" href="/assets/js/39.d1651639.js"><link rel="prefetch" href="/assets/js/4.f4943862.js"><link rel="prefetch" href="/assets/js/40.e3554159.js"><link rel="prefetch" href="/assets/js/41.87e260d1.js"><link rel="prefetch" href="/assets/js/42.4212b868.js"><link rel="prefetch" href="/assets/js/43.720f6908.js"><link rel="prefetch" href="/assets/js/44.93d70e42.js"><link rel="prefetch" href="/assets/js/45.b11d507e.js"><link rel="prefetch" href="/assets/js/46.a09f0770.js"><link rel="prefetch" href="/assets/js/47.3a66043d.js"><link rel="prefetch" href="/assets/js/48.3b6076fb.js"><link rel="prefetch" href="/assets/js/49.d095fb4c.js"><link rel="prefetch" href="/assets/js/5.0be22570.js"><link rel="prefetch" href="/assets/js/50.500bc104.js"><link rel="prefetch" href="/assets/js/6.084d22f4.js"><link rel="prefetch" href="/assets/js/7.dcaafb10.js"><link rel="prefetch" href="/assets/js/8.1c66d85c.js"><link rel="prefetch" href="/assets/js/9.16364959.js">
    <link rel="stylesheet" href="/assets/css/0.styles.926dad4f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Resume/RESUME.html" class="nav-link">
  Resume
</a></div><div class="nav-item"><a href="/Document/Css/Pre.html" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="https://zhao-q.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Resume/RESUME.html" class="nav-link">
  Resume
</a></div><div class="nav-item"><a href="/Document/Css/Pre.html" class="nav-link">
  Document
</a></div><div class="nav-item"><a href="https://zhao-q.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Css</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/Css/Pre.html" class="sidebar-link">使 pre 的内容自动换行</a></li><li><a href="/Document/Css/元素居中.html" class="sidebar-link">元素居中</a></li><li><a href="/Document/Css/滚动条样式.html" class="sidebar-link">滚动条样式</a></li><li><a href="/Document/Css/美化滚动条.html" class="sidebar-link">css 美化滚动条</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/Docker/Docker%E9%83%A8%E7%BD%B2java%E5%BE%AE%E6%9C%8D%E5%8A%A1/" class="sidebar-link">Docker 部署 java 微服务</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Html</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/Html/HTML.html" class="sidebar-link">HTML</a></li><li><a href="/Document/Html/上传类型.html" class="sidebar-link">上传类型</a></li><li><a href="/Document/Html/页面定位到指定位置.html" class="sidebar-link">页面定位到指定位置</a></li><li><a href="/Document/Html/页面嵌入iframe.html" class="sidebar-link">iframe</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>IDE</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/IDE/Eclipse%20%E5%92%8C%20Gradle%20%E5%8D%87%E7%BA%A7%E8%AF%B4%E6%98%8E/" class="sidebar-link">Eclipse 和 Gradle 升级说明</a></li><li><a href="/Document/IDE/Eclipse%20%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95%EF%BC%88Remote%20Debug%EF%BC%89/" class="sidebar-link">Eclipse 远程调试（Remote Debug）</a></li><li><a href="/Document/IDE/Eclipse%E4%B8%8B%E7%94%9F%E6%88%90Java%E7%B1%BB%E5%9B%BE%E5%92%8C%E6%97%B6%E5%BA%8F%E5%9B%BE%EF%BC%8C%E7%94%9F%E6%88%90UML%E5%9B%BE/" class="sidebar-link">Eclipse 下生成 Java 类图和时序图，生成 UML 图</a></li><li><a href="/Document/IDE/Eclipse%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E4%BB%A5%E5%8F%8A%E6%89%93%E5%8C%85%E4%BD%BF%E7%94%A8/" class="sidebar-link">Eclipse 插件开发以及打包使用</a></li><li><a href="/Document/IDE/Notepad++%E9%85%8D%E7%BD%AEJAVA%E7%8E%AF%E5%A2%83/" class="sidebar-link">Notepad++配置JAVA环境</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/Java/@Transactional失效场景.html" class="sidebar-link">@Transactional失效场景及解决办法</a></li><li><a href="/Document/Java/DateFormat日期格式化API.html" class="sidebar-link">日期格式化类 API</a></li><li><a href="/Document/Java/java -jar.html" class="sidebar-link">linux jar 启动脚本</a></li><li><a href="/Document/Java/Java实现线程间通信.html" class="sidebar-link">Java 实现线程间通信</a></li><li><a href="/Document/Java/SpringDataJPA sort多属性排序.html" class="sidebar-link">Spring Data JPA sort 多属性排序</a></li><li><a href="/Document/Java/SpringDataJPA扩展.html" class="sidebar-link">Spring data jpa 扩展实现编写 SQL</a></li><li><a href="/Document/Java/Ueditor%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8/" class="sidebar-link">前后端分离 ueditor 富文本编辑器的使用-Java 版本</a></li><li><a href="/Document/Java/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/" class="sidebar-link">定时任务实现的几种方式：</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JSP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/JSP/JSP.html" class="sidebar-link">JSP java server pages</a></li><li><a href="/Document/JSP/JSTL/" class="sidebar-link">JSTL (JSP 标准标签库，java server pages standard tag libs)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/Linux/CentOS7 firewall-cmd 防火墙.html" class="sidebar-link">CentOS7 firewall-cmd 防火墙</a></li><li><a href="/Document/Linux/FTP.html" class="sidebar-link">FTP</a></li><li><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" aria-current="page" class="active sidebar-link">Linux 常用命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#一、基本命令" class="sidebar-link">一、基本命令</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#二、目录操作命令" class="sidebar-link">二、目录操作命令</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#三、文件操作命令" class="sidebar-link">三、文件操作命令</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#四、压缩文件操作" class="sidebar-link">四、压缩文件操作</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#五、查找命令" class="sidebar-link">五、查找命令</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#六、su、sudo" class="sidebar-link">六、su、sudo</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#七、系统服务" class="sidebar-link">七、系统服务</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#八、网络管理" class="sidebar-link">八、网络管理</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#九、定时任务指令-crontab-配置" class="sidebar-link">九、定时任务指令 crontab 配置</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#十、其他命令" class="sidebar-link">十、其他命令</a></li><li class="sidebar-sub-header"><a href="/Document/Linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/#十一、linux-项目部署" class="sidebar-link">十一、Linux 项目部署</a></li></ul></li><li><a href="/Document/Linux/rabit%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/" class="sidebar-link">rabit 的安装与使用</a></li><li><a href="/Document/Linux/查看Linux系统信息.html" class="sidebar-link">Linux 系统信息</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Nginx</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/Nginx/nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%AF%BC%E8%87%B4session%E5%A4%B1%E6%95%88%E7%9A%84%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/" class="sidebar-link">nginx 反向代理导致 session 失效的问题处理</a></li><li><a href="/Document/Nginx/Nginx%E5%AE%89%E8%A3%85/" class="sidebar-link">Nginx 安装</a></li><li><a href="/Document/Nginx/%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86%E5%92%8C%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/" class="sidebar-link">正向代理 和 反向代理</a></li><li><a href="/Document/Nginx/负载均衡.html" class="sidebar-link">负载均衡</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Quartz</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/Quartz/quartz api 详解.html" class="sidebar-link">Quartz API</a></li><li><a href="/Document/Quartz/quartz%20%E9%A1%B9%E7%9B%AE%E6%95%B4%E5%90%88Springboot/" class="sidebar-link">quartz 项目整合 Springboot</a></li><li><a href="/Document/Quartz/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E6%96%B9%E6%A1%88/" class="sidebar-link">分布式集群任务调度系统开发方案</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Redis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/Redis/数据类型.html" class="sidebar-link">数据类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Spring</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Document/Spring/@Order/" class="sidebar-link">@Order注解</a></li><li><a href="/Document/Spring/AOP%20%E5%92%8C%20IOC/" class="sidebar-link">AOP 和 IOC</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="linux-常用命令"><a href="#linux-常用命令" class="header-anchor">#</a> Linux 常用命令</h1> <h2 id="一、基本命令"><a href="#一、基本命令" class="header-anchor">#</a> 一、基本命令</h2> <p>1.1 关机和重启</p> <p>关机</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>shutdown -h now      立刻关机

shutdown -h 5        5分钟后关机

poweroff             立刻关机
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>重启</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>shutdown -r now      立刻重启

shutdown -r 5        5分钟后重启

reboot               立刻重启
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>1.2 帮助命令</p> <p>--help 命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>shutdown --help：

ifconfig --help：查看网卡信息

man 命令（命令说明书）

man shutdown
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>注意：man shutdown 打开命令说明书之后，使用按键 q 退出</p> <h2 id="二、目录操作命令"><a href="#二、目录操作命令" class="header-anchor">#</a> 二、目录操作命令</h2> <p>2.1 目录切换 cd</p> <p>命令：cd 目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /      切换到根目录

cd /usr   切换到根目录下的 usr 目录

cd ../    切换到上一级目录 或者 cd ..

cd ~      切换到 home 目录

cd -      切换到上次访问的目录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>2.2 目录查看 ls [-al]</p> <p>命令：ls [-al]</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ls           查看当前目录下的所有目录和文件

ls -a        查看当前目录下的所有目录和文件（包括隐藏的文件）

ls -l 或 ll  列表查看当前目录下的所有目录和文件（列表查看，显示更多信息）

ls /dir      查看指定目录下的所有目录和文件 如：ls /usr
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2.3 目录操作【增，删，改，查】</p> <p>2.3.1 创建目录【增】 mkdir</p> <p>命令：mkdir 目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir aaa      在当前目录下创建一个名为 aaa 的目录

mkdir /usr/aaa 在指定目录下创建一个名为 aaa 的目录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2.3.2 删除目录或文件【删】rm</p> <p>命令：rm [-rf] 目录</p> <p>删除文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rm 文件     删除当前目录下的文件

rm -f 文件  删除当前目录的的文件（不询问）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>删除目录：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rm -r aaa   递归删除当前目录下的 aaa 目录

rm -rf aaa  递归删除当前目录下的 aaa 目录（不询问）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>全部删除：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rm -rf \*   将当前目录下的所有目录和文件全部删除

rm -rf /\*  【自杀命令！慎用！慎用！慎用！】将根目录下的所有文件全部删除
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>注意：rm 不仅可以删除目录，也可以删除其他文件或压缩包，为了方便大家的记忆，无论删除任何目录或文件，都直接使用 rm -rf 目录/文件/压缩包</p></blockquote> <p>2.3.3 目录修改【改】mv 和 cp</p> <p>一、重命名目录</p> <p>命令：mv 当前目录 新目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mv aaa bbb    将目录aaa改为bbb
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注意：mv 的语法不仅可以对目录进行重命名而且也可以对各种文件，压缩包等进行 重命名的操作</p></blockquote> <p>二、剪切目录</p> <p>命令：mv 目录名称 目录的新位置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mv /usr/tmp/aaa /usr    将/usr/tmp 目录下的 aaa 目录剪切到 /usr 目录下面
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注意：mv 语法不仅可以对目录进行剪切操作，对文件和压缩包等都可执行剪切操作</p></blockquote> <p>三、拷贝目录</p> <p>命令：cp -r 目录名称 目录拷贝的目标位置 -r 代表递归</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp /usr/tmp/aaa  /usr   将/usr/tmp目录下的aaa目录复制到 /usr目录下面
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注意：cp 命令不仅可以拷贝目录还可以拷贝文件，压缩包等，拷贝文件和压缩包时不 用写-r 递归</p></blockquote> <p>2.3.4 搜索目录【查】find</p> <p>命令：find 目录 参数 文件名称</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find /usr/tmp -name 'a\*' 查找/usr/tmp 目录下的所有以 a 开头的目录或文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="三、文件操作命令"><a href="#三、文件操作命令" class="header-anchor">#</a> 三、文件操作命令</h2> <p>3.1 文件操作【增，删，改，查】</p> <p>3.1.1 新建文件【增】touch</p> <p>命令：touch 文件名</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>touch aa.txt    在当前目录创建一个名为 aa.txt 的文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.1.2 删除文件 【删】 rm</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rm -rf 文件名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.1.3 修改文件【改】 vi 或 vim</p> <p>【vi 编辑器的 3 种模式】
基本上 vi 可以分为三种状态，分别是命令模式（command mode）、插入模式（Insert mode）和底行模式（last line mode），各模式的功能区分如下：</p> <ol><li><p>命令行模式 command mode）</p> <p>控制屏幕光标的移动，字符、字或行的删除，查找，移动复制某区段及进入 Insert mode 下，或者到 last line mode。</p> <p>命令行模式下的常用命令：</p> <p>【1】控制光标移动：↑，↓，j</p> <p>【2】删除当前行：dd</p> <p>【3】查找：/字符</p> <p>【4】进入编辑模式：i o a</p> <p>【5】进入底行模式：:</p></li> <li><p>编辑模式（Insert mode）</p> <p>只有在 Insert mode 下，才可以做文字输入，按「ESC」键可回到命令行模式。</p> <p>编辑模式下常用命令：</p> <p>【1】ESC 退出编辑模式到命令行模式；</p></li> <li><p>底行模式（last line mode）</p> <p>将文件保存或退出 vi，也可以设置编辑环境，如寻找字符串、列出行号……等。</p> <p>底行模式下常用命令：</p> <p>【1】退出编辑： :q</p> <p>【2】强制退出： :q!</p> <p>【3】保存并退出： :wq</p></li></ol> <h5 id="打开文件"><a href="#打开文件" class="header-anchor">#</a> 打开文件</h5> <p>命令：vi 文件名</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi aa.txt 或者 vim aa.txt   打开当前目录下的 aa.txt 文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注意：使用 vi 编辑器打开文件后，并不能编辑，因为此时处于命令模式，点击键盘 i/a/o 进入编辑模式。</p></blockquote> <h5 id="编辑文件"><a href="#编辑文件" class="header-anchor">#</a> 编辑文件</h5> <p>使用 vi 编辑器打开文件后点击按键：i ，a 或者 o 即可进入编辑模式。</p> <p>i: 在光标所在字符前开始插入</p> <p>a: 在光标所在字符后开始插入</p> <p>o: 在光标所在行的下面另起一新行插入</p> <h5 id="保存或者取消编辑"><a href="#保存或者取消编辑" class="header-anchor">#</a> 保存或者取消编辑</h5> <h5 id="保存文件"><a href="#保存文件" class="header-anchor">#</a> 保存文件：</h5> <p>第一步：ESC 进入命令行模式</p> <p>第二步：: 进入底行模式</p> <p>第三步：wq 保存并退出编辑</p> <h5 id="取消编辑"><a href="#取消编辑" class="header-anchor">#</a> 取消编辑：</h5> <p>第一步：ESC 进入命令行模式</p> <p>第二步：: 进入底行模式</p> <p>第三步：q! 撤销本次修改并退出编辑</p> <p>3.1.4 文件的查看【查】</p> <p>文件的查看命令：cat/more/less/tail</p> <p>cat：看最后一屏</p> <p>示例：使用 cat 查看/etc/sudo.conf 文件，只能显示最后一屏内容</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat sudo.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>more：百分比显示</p> <p>示例：使用 more 查看/etc/sudo.conf 文件，可以显示百分比，回车可以向下一行，空格可以向下一页，q 可以退出查看</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>more sudo.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>less：翻页查看</p> <p>示例：使用 less 查看/etc/sudo.conf 文件，可以使用键盘上的 PgUp 和 PgDn 向上 和向下翻页，q 结束查看</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>less sudo.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>tail：指定行数或者动态查看</p> <p>示例：使用 tail -10 查看/etc/sudo.conf 文件的后 10 行，Ctrl+C 结束</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tail -10 sudo.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.2 权限修改</p> <p>rwx：r 代表可读，w 代表可写，x 代表该文件是一个可执行文件，如果 rwx 任意位置变为-则代表不可读或不可写或不可执行文件。</p> <p>示例：给 aaa.txt 文件权限改为可执行文件权限，aaa.txt 文件的权限是-rw-------</p> <p>第一位：-就代表是文件，d 代表是文件夹</p> <p>第一段（3 位）：代表拥有者的权限</p> <p>第二段（3 位）：代表拥有者所在的组，组员的权限</p> <p>第三段（最后 3 位）：代表的是其他用户的权限</p> <p>421 421 421</p> <p><code>- rw- --- ---</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：chmod +x aaa.txt
或者采用 8421 法
命令：chmod 100 aaa.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="四、压缩文件操作"><a href="#四、压缩文件操作" class="header-anchor">#</a> 四、压缩文件操作</h2> <p>4.1 打包和压缩</p> <p>Windows 的压缩文件的扩展名 .zip/.rar</p> <p>linux 中的打包文件：aa.tar</p> <p>linux 中的压缩文件：bb.gz</p> <p>linux 中打包并压缩的文件：.tar.gz</p> <p>Linux 中的打包文件一般是以.tar 结尾的，压缩的命令一般是以.gz 结尾的。</p> <p>而一般情况下打包和压缩是一起进行的，打包并压缩后的文件的后缀名一般.tar.gz。</p> <p>命令： <code>tar -zcvf 打包压缩后的文件名 要打包的文件</code></p> <p>其中：</p> <ul><li>z：调用 gzip 压缩命令进行压缩</li> <li>c：打包文件</li> <li>v：显示运行过程</li> <li>f：指定文件名</li></ul> <p>示例：打包并压缩/usr/tmp 下的所有文件 压缩后的压缩包指定名称为 xxx.tar</p> <p><code>tar -zcvf ab.tar aa.txt bb.txt 或：tar -zcvf ab.tar \*</code></p> <p>4.2 解压</p> <p>命令：tar [-zxvf] 压缩文件</p> <p>其中：x：代表解压</p> <p>示例：将/usr/tmp 下的 ab.tar 解压到当前目录下</p> <p><img src="/assets/img/1.1b4b2b23.png" alt="picture"></p> <p>示例：将/usr/tmp 下的 ab.tar 解压到根目录/usr 下</p> <p><code>tar -xvf ab.tar -C /usr------C 代表指定解压的位置</code></p> <p><img src="/assets/img/2.f7de9de3.png" alt="picture"></p> <h2 id="五、查找命令"><a href="#五、查找命令" class="header-anchor">#</a> 五、查找命令</h2> <p>5.1 grep</p> <p>grep 命令是一种强大的文本搜索工具</p> <p>使用实例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ps -ef | grep sshd                  查找指定 ssh 服务进程
ps -ef | grep sshd | grep -v grep   查找指定服务进程，排除 gerp 身
ps -ef | grep sshd -c               查找指定进程个数
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>5.2 find</p> <p>find 命令在目录结构中搜索文件，并对搜索结果执行指定的操作。</p> <p>find 默认搜索当前目录及其子目录，并且不过滤任何结果（也就是返回所有文件），将它们全都显示在屏幕上。</p> <p>使用实例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -name &quot;_.log&quot; -ls      在当前目录查找以.log 结尾的文件，并显示详细信息。
find /root/ -perm 600         查找/root/目录下权限为 600 的文件
find . -type f -name &quot;_.log&quot;  查找当目录，以.log 结尾的普通文件
find . -type d | sort         查找当前所有目录并排序
find . -size +100M            查找当前目录大于 100M 的文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>5.3 locate</p> <p>locate 让使用者可以很快速的搜寻某个路径。默认每天自动更新一次，所以使用 locate 命令查不到最新变动过的文件。为了避免这种情况，可以在使用 locate 之前，先使用 updatedb 命令，手动更新数据库。如果数据库中没有查询的数据，则会报出 locate: can not stat () `/var/lib/mlocate/mlocate.db': No such file or directory 该错误！updatedb 即可！</p> <p><strong>yum -y install mlocate 如果是精简版 CentOS 系统需要安装 locate 命令</strong></p> <p>使用实例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>updatedb
locate /etc/sh  搜索 etc 目录下所有以 sh 开头的文件
locate pwd      查找和 pwd 相关的所有文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>5.4 whereis</p> <p>whereis 命令是定位可执行文件、源代码文件、帮助文件在文件系统中的位置。这些文件的属性应属于原始代码，二进制文件，或是帮助文件。</p> <p>使用实例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>whereis ls 将和 ls 文件相关的文件都查找出来
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>5.5 which</p> <p>which 命令的作用是在 PATH 变量指定的路径中，搜索某个系统命令的位置，并且返回第一个搜索结果。</p> <p>使用实例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>which pwd   查找 pwd 命令所在路径
which java  查找 path 中 java 的路径
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="六、su、sudo"><a href="#六、su、sudo" class="header-anchor">#</a> 六、su、sudo</h2> <p>6.1 su</p> <p>su 用于用户之间的切换。但是切换前的用户依然保持登录状态。如果是 root 向普通或虚拟用户切换不需要密码，反之普通用户切换到其它任何用户都需要密码验证。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>su test:    切换到 test 用户，但是路径还是/root 目录
su - test : 切换到 test 用户，路径变成了/home/test
su :        切换到 root 用户，但是路径还是原来的路径
su - :      切换到 root 用户，并且路径是/root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>su 不足：如果某个用户需要使用 root 权限、则必须要把 root 密码告诉此用户。</p> <p>退出返回之前的用户： <code>exit</code></p> <p>6.2 sudo</p> <p>sudo 是为所有想使用 root 权限的普通用户设计的。可以让普通用户具有临时使用 root 权限的权利。只需输入自己账户的密码即可。</p> <p>进入 sudo 配置文件命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /etc/sudoer 或者 visudo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>案例：
允许 hadoop 用户以 root 身份执行各种应用命令，需要输入 hadoop 用户的密码。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hadoop ALL=(ALL) ALL
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>案例：
只允许 hadoop 用户以 root 身份执行 ls 、cat 命令，并且执行时候免输入密码。
配置文件中：
hadoop ALL=NOPASSWD: /bin/ls, /bin/cat</p> <h2 id="七、系统服务"><a href="#七、系统服务" class="header-anchor">#</a> 七、系统服务</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>service iptables status   --查看 iptables 服务的状态
service iptables start    --开启 iptables 服务
service iptables stop     --停止 iptables 服务
service iptables restart  --重启 iptables 服务

chkconfig iptables off    --关闭 iptables 服务的开机自启动
chkconfig iptables on     --开启 iptables 服务的开机自启动
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="八、网络管理"><a href="#八、网络管理" class="header-anchor">#</a> 八、网络管理</h2> <p>8.1 主机名配置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@node1 ~]# vi /etc/sysconfig/network
NETWORKING=yes
HOSTNAME=node1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>8.2 IP 地址配置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@node1 ~]# vi /etc/sysconfig/network-scripts/ifcfg-eth0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>8.3 域名映射</p> <p>/etc/hosts 文件用于在通过主机名进行访问时做 ip 地址解析之用。所以，你想访问一个什么样的主机名，就需要把这个主机名和它对应的 ip 地址。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@node1 ~]# vi /etc/hosts

#### 在最后加上

192.168.52.201 node1
192.168.52.202 node2
192.168.52.203 node3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="九、定时任务指令-crontab-配置"><a href="#九、定时任务指令-crontab-配置" class="header-anchor">#</a> 九、定时任务指令 crontab 配置</h2> <p>crontab 是 Unix 和 Linux 用于设置定时任务的指令。通过 crontab 命令，可以在固定间隔时间, 执行指定的系统指令或 shell 脚本。时间间隔的单位可以是分钟、小时、日、月、周及以上的任意组合。</p> <p>crontab 安装：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum install crontabs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>服务操作说明：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>service crond start   ## 启动服务
service crond stop    ## 关闭服务
service crond restart ## 重启服务
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>9.1 命令格式</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>crontab [-u user] file

crontab [-u user][ -e | -l | -r ]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数说明：</p> <p><code>-u user</code> ：用来设定某个用户的 crontab 服务</p> <p><code>file</code> ：file 是命令文件的名字, 表示将 file 做为 crontab 的任务列表文件</p> <p>并载入 crontab。</p> <p><code>-e</code> ：编辑某个用户的 crontab 文件内容。如果不指定用户，则表示编辑当前</p> <p>用户的 crontab 文件。</p> <p><code>-l</code> ：显示某个用户的 crontab 文件内容。如果不指定用户，则表示显示当前</p> <p>用户的 crontab 文件内容。</p> <p><code>-r</code> ：删除定时任务配置，从/var/spool/cron 目录中删除某个用户的 crontab</p> <p>文件，如果不指定用户，则默认删除当前用户的 crontab 文件。</p> <p>命令示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>crontab file [-u user]  ## 用指定的文件替代目前的 crontab
crontab -l [-u user]    ## 列出用户目前的 crontab
crontab -e [-u user]    ## 编辑用户目前的 crontab
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>9.2 配置说明、实例</p> <p>命令： <code>* * * * * command</code></p> <p>解释：分 时 日 月 周 命令</p> <p>第 1 列表示分钟 1 ～ 59 每分钟用*或者 */1 表示</p> <p>第 2 列表示小时 0 ～ 23（0 表示 0 点）</p> <p>第 3 列表示日期 1 ～ 31</p> <p>第 4 列表示月份 1 ～ 12</p> <p>第 5 列标识号星期 0 ～ 6（0 表示星期天）</p> <p>第 6 列要运行的命令</p> <p>配置实例：</p> <p>先打开定时任务所在的文件：
<code>crontab -e</code></p> <p>每分钟执行一次 date 命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>_/1 _ * * * date &gt;&gt; /root/date.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>每晚的 21:30 重启 apache。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>30 21 * * * service httpd restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>每月 1、10、22 日的 4 : 45 重启 apache。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>45 4 1,10,22 * * service httpd restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>每周六、周日的 1 : 10 重启 apache。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>10 1 * * 6,0 service httpd restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>每天 18 : 00 至 23 : 00 之间每隔 30 分钟重启 apache。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>0,30 18-23 * * * service httpd restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>晚上 11 点到早上 7 点之间，每隔一小时重启 apache</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>- 23-7/1 * * * service httpd restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="十、其他命令"><a href="#十、其他命令" class="header-anchor">#</a> 十、其他命令</h2> <p>10.1 查看当前目录：pwd</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>pwd 查看当前目录路径
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.2 查看进程：ps -ef</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ps -ef 查看所有正在运行的进程
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.3 结束进程：kill</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：kill pid 或者 kill -9 pid(强制杀死进程) pid:进程号
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.4 网络通信命令：</p> <p>ifconfig：查看网卡信息</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：ifconfig 或 ifconfig | more
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ping：查看与某台机器的连接情况</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：ping ip
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>netstat -an：查看当前系统端口</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：netstat -an
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>搜索指定端口</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：netstat -an | grep 8080
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.5 配置网络</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：setup
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.6 重启网络</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：service network restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.7 切换用户</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：su - 用户名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.8 关闭防火墙</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：chkconfig iptables off

或者：

iptables -L;
iptables -F;
service iptables stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>10.9 修改文件权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：chmod 777
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.10 清屏</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>命令：ctrl + l
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.11 vi 模式下快捷键</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>esc 后:

保存并退出快捷键：shift+z+z

光标跳到最后一行快捷键：shift+g

删除一行：dd

复制一行内容：y+y

粘贴复制的内容：p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="十一、linux-项目部署"><a href="#十一、linux-项目部署" class="header-anchor">#</a> 十一、Linux 项目部署</h2> <p>11.1 安装 jdk1.8</p> <p>先卸载 open-jdk</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>java -version

rpm -qa | grep java

rpm -e --nodeps java-1.7.0-openjdk-1.7.0.45-2.4.3.3.el6.x86_64

rpm -e --nodeps java-1.6.0-openjdk-1.6.0.0-1.66.1.13.0.el6.x86_64
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>开始安装：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir /usr/local/src/java

rz 上传 jdk tar 包

tar -zxvf jdk-8u181-linux-x64.tar.gz

yum install glibc.i686
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>配置环境变量：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /etc/profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在末尾行添加</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#set java environment

JAVA_HOME=/usr/local/src/jdk8/jdk1.8.0_181

CLASSPATH=.:\$JAVA_HOME/lib.tools.jar

PATH=$JAVA_HOME/bin:$PATH

export JAVA_HOME CLASSPATH PATH
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># vim /etc/profile

export JAVA_HOME=/usr/java
export JRE_HOME=${JAVA_HOME}/jre
export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib:$CLASSPATH
export JAVA_PATH=${JAVA_HOME}/bin:${JRE_HOME}/bin
export PATH=$PATH:${JAVA_PATH}

# source /etc/profile 使更改的配置立即生效
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>保存退出</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>source /etc/profile 使更改的配置立即生效

java -version 查看 JDK 版本信息，如果显示出 1.8 证明成功
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>11.2 安装 MySQL5.6</p> <p>11.2.1 上传 MySQL5.6 的 tar 包</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>创建目录：mkdir /usr/local/src/mysql5.6

上传：MySQL-5.6.34-1.rhel5.x86_64.rpm-bundle.tar 到上面的目录中
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>11.2.2 安装</p> <p>第一步：解压</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>     命令：tar -xvf MySQL-5.6.34-1.rhel5.x86_64.rpm-bundle.tar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第二步：检测是否已经安装了 mysql</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>     命令：rpm -qa | grep mysql

     如果已经安装了，将其卸载，如：

     rpm -e --nodeps  mysql-libs-5.1.71-1.el6.x86_64
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>第三步：安装 MySQL 的服务端</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>     命令：rpm -ivh MySQL-server-5.6.34-1.rhel5.x86_64.rpm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第四步：安装 MySQL 的客户端</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>     命令：rpm -ivh MySQL-client-5.6.34-1.rhel5.x86_64.rpm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第五步：查看 MySQL 服务运行状态</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>     命令：service mysql status
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第六步：启动 MySQL 服务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>     命令：service mysql start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第七步：使用 root 账号登录 mysql</p> <p>在安装 mysql server 时有句提示：</p> <p><img src="/assets/img/3.ab4bc94d.png" alt="picture"></p> <p>注意：这个密码是不安全的，所有需要修改初始密码。
使用密码登录 mysql 账号：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mysql -uroot -p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改 root 密码：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SET PASSWORD = PASSWORD('root');
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.2.3 开机自动启动设置</p> <p>加入到系统服务：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chkconfig --add mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>自动启动：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chkconfig mysql on
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查询列表：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chkconfig
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>说明：都没关闭（off）时是没有自动启动。</p> <p>11.2.4 开启远程访问</p> <p>登录：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mysql -uroot –proot
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>设置远程访问（使用 root 密码）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>grant all privileges on _._ to 'root' @'%' identified by 'root';

flush privileges;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>退出 mysql，在 centos 环境下打开 3306 防火墙</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/sbin/iptables -I INPUT -p tcp --dport 3306 -j ACCEPT

/etc/rc.d/init.d/iptables save

/etc/init.d/iptables status
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>11.3 安装 tomcat 部署项目</p> <p>准备工作：将 web 项目打成 war 包，改名为 ROOT.war</p> <p>11.3.1 创建 ucenter 用户</p> <p>一般情况下，发布应用程序都不是使用 root 用户的，需要创建一个普通用户来发布程序；</p> <p>创建 ucenter 用户：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>useradd -d /ucenter ucenter
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>设置密码：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>passwd ucenter （密码 ucenter）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>切换用户：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>su - ucenter
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.3.2 安装 Tomcat</p> <p>tomcat 只要解压就可以使用。</p> <p>1、创建 web 目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir /ucenter/web
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2、上传 apache-tomcat-7.0.57.tar.gz</p> <p>3、解压： <code>tar -xvf apache-tomcat-7.0.57.tar.gz</code></p> <p>4、重命名： <code>mv apache-tomcat-7.0.57 itcast-usermanage</code></p> <p>5、启动 tomcat：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd itcast-usermanage/bin/

./startup.sh 或者 sh startup.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>6、查看日志：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tail -f ../logs/catalina.out
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>7、查看效果 http://192.168.0.160:8080/</p> <p>发现无法访问：</p> <p><img src="/assets/img/4.3451dcca.png" alt="picture"></p> <p>8、防火墙打开 8080 端口</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/sbin/iptables -I INPUT -p tcp --dport 8080 -j ACCEPT

/etc/rc.d/init.d/iptables save
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>9、安装成功</p> <p><img src="/assets/img/5.c38f9c3a.png" alt="picture"></p> <p>11.3.3 部署用户管理项目</p> <p>1、上传 usermanage.sql 和 ROOT.war 到/ucenter/web</p> <p>2、执行数据库脚本</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat user_manager.sql | mysql -uroot -p123456
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3、部署 web 程序</p> <p>3.1 删除 webapps 下的所有文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /ucenter/web/usermanage/webapps

rm -rf *
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>3.2 拷贝 ROOT.war 到 webapps</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp /ucenter/web/ROOT.war .
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.3 重新启动 tomcat</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd ../bin/

sh startup.sh &amp;&amp; tail -f ../logs/catalina.out
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>3.4 启动浏览器测试</p> <p>注意事项：Centos 环境下部署项目中文乱码问题解决方案</p> <div class="language- extra-class"><pre><code>今天在一台新的CentOS机器上使用c3p0连接池操作mysql数据库出现中文乱码问题，具体表现为：查询时无中文乱码问题，写数据时中文乱码，查看了机器上数据库字符集也是UTF8，应该不会出现中文乱码才对，最后在c3p0配置文件中 jdbcUrl后加上：?useUnicode=true&amp;amp;characterEncoding=UTF8 中文就不会乱码了。
</code></pre></div><p>【C3P0 配置文件】</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c3p0-config</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>default-config</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driverClass<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbcUrl<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>jdbc:mysql://localhost:3306/user_manager_yun6?useUnicode=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>characterEncoding=UTF8 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>acquireIncrement<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>initialPoolSize<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>minPoolSize<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>maxPoolSize<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>default-config</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c3p0-config</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>11.4 Linux 下使用 FastDFS</p> <p>相关的安装包我打包到云盘上了，链接：https://pan.baidu.com/s/13NDYYil4mgLhkb5CYsc2Ww 提取码：66tn</p> <p>单节点 FastDFS</p> <p>整个安装过程非常复杂，很容易出错，建议进行多次备份。</p> <p>我们这里不打算安装多台虚拟机，因此会把 tracker 和 storage 都安装在一起。</p> <p>11.4.1 安装 gcc</p> <p>GCC 用来对 C 语言代码进行编译运行，使用 yum 命令安装：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum -y install gcc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>后面会用到解压命令（unzip），所以这里可以用 yum 把 unzip 也装一下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum install -y unzip zip
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.4.2 安装 libevent</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum -y install libevent
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.4.3 安装 libfastcommon-master</p> <p>解压刚刚上传的 libfastcommon-master.zip</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>unzip libfastcommon-master.zip
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>进入解压完成的目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd libfastcommon-master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>编译并且安装：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>./make.sh

./make.sh install
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>11.4.4 安装 fastdfs</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -zxvf FastDFS_v5.08.tar.gz
cd FastDFS
./make.sh
./make.sh install
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果安装成功，会看到/etc/init.d/下看到提供的脚本文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ll /etc/init.d/ | grep fdfs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/6.f7265ba6.png" alt="picture"></p> <ul><li>fdfs_trackerd 是 tracker 启动脚本</li> <li>fdfs_storaged 是 storage 启动脚本</li></ul> <p>能够在 /etc/fdfs/ 目录下看到默认的配置文件模板：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ll /etc/fdfs/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/7.b6a314cf.png" alt="picture"></p> <ul><li>tarcker.conf.sample 是 tracker 的配置文件模板</li> <li>storage.conf.sample 是 storage 的配置文件模板</li> <li>client.conf.sample 是客户端的配置文件模板</li></ul> <br> <p>11.4.5 配置并启动 tracker 服务</p> <p>1）首先将模板文件复制</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp /etc/fdfs/tracker.conf.sample /etc/fdfs/tracker.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2）修改复制后的配置文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim /etc/fdfs/tracker.conf

# 修改的内容如下：

base_path=/项目名/tracker # 存储日志和数据的根目录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>3）新建目录：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir -p /项目名/tracker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注意：关闭防火墙：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chkconfig iptables off
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4）启动和停止</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>service fdfs_trackerd start # 启动 fdfs_trackerd 服务，停止用 stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>检查 FastDFS Tracker Server 是否启动成功：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ps -ef | grep fdfs_trackerd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>设置 tracker 服务开机启动:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chkconfig fdfs_trackerd on
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.4.6 配置并启动 storage 服务</p> <p>1）首先将模板文件复制</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp /etc/fdfs/storage.conf.sample /etc/fdfs/storage.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2）修改复制后的配置文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim /etc/fdfs/storage.conf

# 修改的内容如下:

base_path=/项目名/storage # 数据和日志文件存储根目录

store_path0=/项目名/storage # 第一个存储目录

tracker_server=192.168.56.101:22122 # tracker 服务器 IP 和端口
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>3）新建目录：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir -p /项目名/storage

注意关闭防火墙： chkconfig iptables off
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>4）启动和停止</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>service fdfs_storaged start # 启动 fdfs_storaged 服务，停止用 stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>设置 storage 服务开机启动：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chkconfig fdfs_storaged on

ps -ef | grep fdfs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/assets/img/8.183fb7cd.png" alt="picture"></p> <p>11.5 安装 fastdfs-nginx-module</p> <p>11.5.1 解压</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -zxvf fastdfs-nginx-module_v1.16.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.5.2 修改 config</p> <p>1）进入 src 目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd fastdfs-nginx-module/src/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2）编辑 config</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用以下底行命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>:%s+/usr/local/+/usr/+g
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将所有的/usr/local 替换为 /usr，这个才是正确的目录:</p> <p><img src="/assets/img/9.ca2dee8f.png" alt="picture"></p> <p>11.5.3 配置 nginx 与 FastDFS 关联配置文件</p> <p>复制 fastdfs-nginx-module 源码中的配置文件到/etc/fdfs 目录， 并修改</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp /usr/local/项目名/fastdfs-nginx-module/src/mod_fastdfs.conf /etc/fdfs/

vi /etc/fdfs/mod_fastdfs.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>修改以下配置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>connect_timeout=10 # 客户端访问文件连接超时时长（单位：秒）

tracker_server=192.168.56.101:22122 # tracker 服务 IP 和端口

url_have_group_name=true # 访问链接前缀加上组名

store_path0=/leyou/storage # 文件存储路径
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>复制 FastDFS 的部分配置文件到/etc/fdfs 目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /usr/local/项目名/FastDFS/conf/
cp http.conf mime.types /etc/fdfs/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>11.6 安装 Nginx 的插件</p> <p>11.6.1 如果没有安装过 nginx</p> <p>1、安装 nginx 的依赖库</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum -y install gcc pcre pcre-devel zlib zlib-devel openssl openssl-devel
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2、解压安装包</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -zxvf nginx-1.10.0.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3、配置 nginx 安装包，并指定 fastdfs-nginx-model</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd nginx-1.10.0

./configure --prefix=/opt/nginx --sbin-path=/usr/bin/nginx --add-module=/usr/local/leyou/fastdfs-nginx-module/src
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>注意：在执行./configure 配置 nginx 参数的时候，需要将 fastdfs-nginx-moudle 源码作为模块编译进去。</p> <p>4、编译并安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>make &amp;&amp; make install
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.6.2 如果已经安装过 nginx</p> <p>1、 进入 nginx 目录：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /usr/local/项目名/nginx-1.10.0/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2、 配置 FastDFS 模块</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>./configure --prefix=/opt/nginx --sbin-path=/usr/bin/nginx --add-module=/usr/local/项目名/fastdfs-nginx-module/src
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注意：这次配置时，要添加 fastdfs-nginx-moudle 模块</p> <p>3、编译，注意，这次不要安装（install）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>make
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4、替换 nginx 二进制文件:</p> <p>备份：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mv /usr/bin/nginx /usr/bin/nginx-bak
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>用新编译的 nginx 启动文件替代原来的：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp objs/nginx /usr/bin/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.6.3 启动 nginx</p> <p>配置 nginx 整合 fastdfs-module 模块</p> <p>我们需要修改 nginx 配置文件，在/opt/nginx/config/nginx.conf 文件中：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim /opt/nginx/conf/nginx.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将文件中，原来的 server 80{ ...} 部分代码替换为如下代码：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>server {
  listen 80;
  server_name image.项目名.com; # 监听域名中带有 group 的，交给 FastDFS 模块处理
  location ~/group([0-9])/ {
    ngx_fastdfs_module;
  }
  location / {
    root html;
    index index.html index.htm;
  }
  error_page 500 502 503 504 /50x.html;
  location = /50x.html {
    root html;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>启动 nginx：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>nginx # 启动 nginx

nginx -s stop # 停止 nginx

nginx -s reload # 重新载入配置文件

# 可通过 ps -ef | grep nginx 查看 nginx 是否已启动成功
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/assets/img/10.d91a0844.png" alt="picture"></p> <p>11.6.4 设置 nginx 开机启动</p> <p>创建一个开机启动的脚本：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim /etc/init.d/nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>添加以下内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/sh

#

# nginx - this script starts and stops the nginx daemon

#

# chkconfig: - 85 15

# description: NGINX is an HTTP(S) server, HTTP(S) reverse \

# proxy and IMAP/POP3 proxy server

# processname: nginx

# config: /etc/nginx/nginx.conf

# config: /etc/sysconfig/nginx

# pidfile: /var/run/nginx.pid

# Source function library.

. /etc/rc.d/init.d/functions

# Source networking configuration.

. /etc/sysconfig/network

# Check that networking is up.

[ &quot;$NETWORKING&quot; = &quot;no&quot; ] &amp;&amp; exit 0

nginx=&quot;/usr/bin/nginx&quot;
prog=$(basename $nginx)

NGINX_CONF_FILE=&quot;/opt/nginx/conf/nginx.conf&quot;

[ -f /etc/sysconfig/nginx ] &amp;&amp; . /etc/sysconfig/nginx

lockfile=/var/lock/subsys/nginx

make_dirs() {

# make required directories

user=`$nginx -V 2&gt;&amp;1 | grep &quot;configure arguments:.*--user=&quot; | sed 's/[^*]*--user=\([^ ]*\).*/\1/g' -`
if [ -n &quot;$user&quot; ]; then
if [ -z &quot;`grep $user /etc/passwd`&quot; ]; then
useradd -M -s /bin/nologin \$user
fi
options=`$nginx -V 2&gt;&amp;1 | grep 'configure arguments:'`
for opt in \$options; do
if [ `echo $opt | grep '.*-temp-path'` ]; then
value=`echo $opt | cut -d &quot;=&quot; -f 2`
if [ ! -d &quot;$value&quot; ]; then # echo &quot;creating&quot; $value
                  mkdir -p $value &amp;&amp; chown -R $user $value
fi
fi
done
fi
}

start() {
[ -x $nginx ] || exit 5
[ -f $NGINX_CONF_FILE ] || exit 6
make_dirs
echo -n $&quot;Starting $prog: &quot;
daemon $nginx -c $NGINX_CONF_FILE
retval=$?
    echo
    [ $retval -eq 0 ] &amp;&amp; touch $lockfile
    return $retval
}

stop() {
echo -n $&quot;Stopping $prog: &quot;
killproc $prog -QUIT
    retval=$?
echo
[ $retval -eq 0 ] &amp;&amp; rm -f $lockfile
    return $retval
}

restart() {
configtest || return \$?
stop
sleep 1
start
}

reload() {
configtest || return $?
    echo -n $&quot;Reloading $prog: &quot;
    killproc $nginx -HUP
RETVAL=\$?
echo
}

force_reload() {
restart
}

configtest() {
$nginx -t -c $NGINX_CONF_FILE
}

rh_status() {
status \$prog
}

rh_status_q() {
rh_status &gt;/dev/null 2&gt;&amp;1
}

case &quot;$1&quot; in
    start)
        rh_status_q &amp;&amp; exit 0
        $1
;;
stop)
rh_status_q || exit 0
$1
        ;;
    restart|configtest)
        $1
;;
reload)
rh_status_q || exit 7
$1
        ;;
    force-reload)
        force_reload
        ;;
    status)
        rh_status
        ;;
    condrestart|try-restart)
        rh_status_q || exit 0
            ;;
    *)
        echo $&quot;Usage: \$0 {start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest}&quot;
exit 2
esac
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br></div></div><p>修改文件权限，并加入服务列表</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 修改权限

chmod 777 /etc/init.d/nginx

# 添加到服务列表

chkconfig --add /etc/init.d/nginx

设置开机启动

chkconfig nginx on
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>11.7 安装 Elasticsearch</p> <p>需要虚拟机 JDK1.8 及以上</p> <p>11.7.1 新建一个用户 leyou</p> <p>出于安全考虑，elasticsearch 默认不允许以 root 账号运行。</p> <p>创建用户：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>useradd leyou
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>设置密码：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>passwd leyou
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>切换用户：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>su - leyou
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.7.2 上传安装包, 并解压</p> <p>我们将安装包上传到：/home/leyou 目录</p> <p>解压缩：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -zxvf elasticsearch-6.2.4.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们把目录重命名：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mv elasticsearch-6.3.0/ elasticsearch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/11.e40eb3f9.png" alt="picture"></p> <p>进入，查看目录结构：</p> <p><img src="/assets/img/12.5c23e1e9.png" alt="picture"></p> <p>11.7.3 修改配置</p> <p>我们进入 config 目录： <code>cd config</code></p> <p>需要修改的配置文件有两个：</p> <p><img src="/assets/img/13.35213123.png" alt="picture"></p> <p>1、jvm.options</p> <p>Elasticsearch 基于 Lucene 的，而 Lucene 底层是 java 实现，因此我们需要配置 jvm 参数。</p> <p>编辑 jvm.options：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim jvm.options
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>默认配置如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>-Xms1g

-Xmx1g
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>内存占用太多了，我们调小一些：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>-Xms512m

-Xmx512m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2、elasticsearch.yml</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim elasticsearch.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改数据和日志目录：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>path.data: /home/leyou/elasticsearch/data # 数据目录位置
path.logs: /home/leyou/elasticsearch/logs # 日志目录位置
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>我们把 data 和 logs 目录修改指向了 elasticsearch 的安装目录。但是这两个目录并不存在，因此我们需要创建出来。</p> <p>进入 elasticsearch 的根目录，然后创建：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir data
mkdir logs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/assets/img/14.82a6f009.png" alt="picture"></p> <p>修改绑定的 ip：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>network.host: 0.0.0.0 # 绑定到 0.0.0.0，允许任何 ip 来访问
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>默认只允许本机访问，修改为 0.0.0.0 后则可以远程访问</p> <p>11.7.4 运行</p> <p>进入 elasticsearch/bin 目录，可以看到下面的执行文件：</p> <p><img src="/assets/img/15.be077a9d.png" alt="picture"></p> <p>然后输入命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>./elasticsearch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>或者后台运行：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>./elasticsearch -d
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.7.5 错误 1：内核过低</p> <p><img src="/assets/img/16.a1485490.png" alt="picture"></p> <p>修改 elasticsearch.yml 文件，在最下面添加如下配置： 然后重启</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bootstrap.system_call_filter: false
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.7.6 错误 2：文件权限不足</p> <p><img src="/assets/img/17.fba16cf5.png" alt="picture"></p> <p>我们用的是 leyou 用户，而不是 root，所以文件权限不足。</p> <p>首先用 root 用户登录。直接输入 exit 命令</p> <p>然后修改配置文件:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim /etc/security/limits.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>添加下面的内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>- soft nofile 65536

- hard nofile 131072

- soft nproc 4096

- hard nproc 4096

  11.7.7 错误 3：线程数不够

[1]: max number of threads [1024] for user [leyou] is too low, increase to at least [4096]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>继续修改配置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim /etc/security/limits.d/90-nproc.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改下面的内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>- soft nproc 1024
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>改为</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>- soft nproc 4096
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.7.8 错误 4：进程虚拟内存</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[3]: max virtual memory areas vm.max_map_count [65530] likely too low, increase to at least [262144]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>vm.max_map_count：限制一个进程可以拥有的 VMA(虚拟内存区域)的数量，继续修改配置文件， ：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim /etc/sysctl.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>添加下面内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vm.max_map_count=655360
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后执行命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>sysctl -p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.7.9 重启终端窗口</p> <p>所有错误修改完毕，一定要重启你的 Xshell 终端，否则配置无效。</p> <p>11.8 安装 RabbitMQ</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /usr/local/myapp

mkdir rabbitmq

cd rabbitmq
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>11.8.1 安装 Erlang</p> <p>1、在线安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum install esl-erlang_17.3-1~centos~6_amd64.rpm

yum install esl-erlang-compat-R14B-1.el6.noarch.rpm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2、离线安装</p> <p><img src="/assets/img/18.e85016c4.png" alt="picture"></p> <p>依次执行命令：</p> <p>1） <code>rpm -ivh esl-erlang-17.3-1.x86_64.rpm --force --nodeps</code></p> <p><img src="/assets/img/19.eb9b5fed.png" alt="picture"></p> <p>2） <code>rpm -ivh esl-erlang_17.3-1~centos~6_amd64.rpm --force --nodeps</code></p> <p><img src="/assets/img/20.6d6769f9.png" alt="picture"></p> <p>3） <code>rpm -ivh esl-erlang-compat-R14B-1.el6.noarch.rpm --force --nodeps</code></p> <p><img src="/assets/img/21.963def33.png" alt="picture"></p> <p>11.8.2 安装 RabbitMQ</p> <p><img src="/assets/img/22.81874de5.png" alt="picture"></p> <p>安装：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rpm -ivh rabbitmq-server-3.4.1-1.noarch.rpm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/23.a282070b.png" alt="picture"></p> <p>11.8.3 设置配置文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp /usr/share/doc/rabbitmq-server-3.4.1/rabbitmq.config.example
/etc/rabbitmq/rabbitmq.config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>开启用户远程访问</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /etc/rabbitmq/rabbitmq.config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/24.ec7639ea.png" alt="picture"></p> <p><strong>注意要去掉后面的逗号。</strong></p> <p>11.8.4 启动、停止</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>service rabbitmq-server start

service rabbitmq-server stop

service rabbitmq-server restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>11.8.5 开启 web 界面管理工具</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rabbitmq-plugins enable rabbitmq_management

service rabbitmq-server restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>11.8.6 设置开机启动</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chkconfig rabbitmq-server on
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>11.8.7 防火墙开放 15672 端口</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/sbin/iptables -I INPUT -p tcp --dport 15672 -j ACCEPT

/etc/rc.d/init.d/iptables save
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>11.9 redis 安装和配置</p> <p>11.9.1 安装</p> <p>解压</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -xvf redis-4.0.9.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>编译安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mv redis-4.0.9 redis
cd redis
make &amp;&amp; make install
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>11.9.2 配置</p> <p>修改安装目录下的 redis.conf 文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim redis.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改以下配置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#bind 127.0.0.1 # 将这行代码注释，监听所有的 ip 地址，外网可以访问
protected-mode no # 把 yes 改成 no，允许外网访问
daemonize yes # 把 no 改成 yes，后台运行
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>11.9.3 启动或停止</p> <p>redis 提供了服务端命令和客户端命令：</p> <ul><li><p>redis-server 服务端命令，可以包含以下参数： start 启动 stop 停止</p></li> <li><p>redis-cli 客户端控制台，包含参数： -h xxx 指定服务端地址，缺省值是 127.0.0.1 -p xxx 指定服务端端口，缺省值是 6379</p> <p>11.9.4 设置开机启动</p></li></ul> <ol><li>输入命令，新建文件</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim /etc/init.d/redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>输入下面内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/sh

# chkconfig: 2345 90 10

# description: Redis is a persistent key-value database

PATH=/usr/local/bin:/sbin:/usr/bin:/bin

REDISPORT=6379
EXEC=/usr/local/bin/redis-server
REDIS_CLI=/usr/local/bin/redis-cli

PIDFILE=/var/run/redis.pid

CONF=&quot;/usr/local/leyou/redis/redis.conf&quot;

case &quot;$1&quot; in
    start)
        if [ -f $PIDFILE ]
 then
 echo &quot;$PIDFILE exists, process is already running or crashed&quot;
        else
                echo &quot;Starting Redis server...&quot;
                $EXEC $CONF
        fi
        if [ &quot;$?&quot;=&quot;0&quot; ]
 then
 echo &quot;Redis is running...&quot;
 fi
 ;;
 stop)
 if [ ! -f $PIDFILE ]
 then
 echo &quot;$PIDFILE does not exist, process is not running&quot;
        else
                PID=$(cat $PIDFILE)
                echo &quot;Stopping ...&quot;
                $REDIS_CLI -p $REDISPORT SHUTDOWN
                while [ -x ${PIDFILE} ]
 do
 echo &quot;Waiting for Redis to shutdown ...&quot;
 sleep 1
 done
 echo &quot;Redis stopped&quot;
 fi
 ;;
 restart|force-reload)
 ${0} stop
        ${0} start
 ;;
 \*)
 echo &quot;Usage: /etc/init.d/redis {start|stop|restart|force-reload}&quot; &gt;&amp;2
 exit 1
esac
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><p>然后保存退出</p> <p>注意：以下信息需要根据安装目录进行调整：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>EXEC=/usr/local/bin/redis-server # 执行脚本的地址

REDIS_CLI=/usr/local/bin/redis-cli # 客户端执行脚本的地址

PIDFILE=/var/run/redis.pid # 进程 id 文件地址

CONF=&quot;/usr/local/src/redis-3.0.2/redis.conf&quot; #配置文件地址
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2）设置权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chmod 755 /etc/init.d/redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3）启动测试</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/etc/init.d/redis start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>启动成功会提示如下信息：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Starting Redis server...

Redis is running...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>4）设置开机自启动</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chkconfig --add /etc/init.d/redis
chkconfig redis on
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.77c060c5.js" defer></script><script src="/assets/js/2.dd98a60a.js" defer></script><script src="/assets/js/3.4b608a10.js" defer></script>
  </body>
</html>
